<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CPU Scheduling</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='design.css') }}">
  <script>
    function updateFormFields() {
      var algorithm = document.getElementById("algorithm").value;
      var processList = document.getElementById("processList");
      var quantumSection = document.getElementById("quantumSection");

      // FCFS only requires Arrival Time and Burst Time (no Priority or Quantum)
      var showPriority = (algorithm.includes("Priority"));
      var showQuantum = (algorithm === "Round Robin");

      // Update visibility of quantum input and process fields
      quantumSection.style.display = showQuantum ? "block" : "none";

      var allProcesses = document.querySelectorAll(".process-entry");
      allProcesses.forEach((process) => {
        var priorityInput = process.querySelector(".priorityInput");
        if (showPriority) {
          priorityInput.classList.add("visible");
        } else {
          priorityInput.classList.remove("visible");
        }
      });
    }

    function updateProcessFields() {
      var count = parseInt(document.getElementById("processCount").value);
      var processList = document.getElementById("processList");
      processList.innerHTML = ""; // Clear existing process fields

      for (var i = 1; i <= count; i++) {
        var processDiv = document.createElement("div");
        processDiv.classList.add("process-entry");

        processDiv.innerHTML = `
          <label>Process ${i}:</label>
          <input type="hidden" name="process_names[]" value="P${i}">
          
          <label>Arrival Time:</label>
          <input type="number" name="arrival_times[]" required>

          <label>Burst Time:</label>
          <input type="number" name="burst_times[]" required>
          
          <label class="priorityInput" style="display:none;">Priority:</label>
          <input class="priorityInput" style="display:none;" type="number" name="priorities[]">
          <br>
        `;
        processList.appendChild(processDiv);
      }

      updateFormFields(); // Ensure correct fields are displayed
    }
  </script>
</head>
<body onload="updateProcessFields(); updateFormFields();">
  <header>
    <h1>CPU Scheduling</h1>
  </header>

  <main>
    <h2>Select Scheduling Algorithm</h2>
    <form action="/" method="post">
      <label for="algorithm">Algorithm:</label>
      <select id="algorithm" name="algorithm" onchange="updateFormFields()">
        <option value="FCFS">First Come First Serve (FCFS)</option>
        <option value="SJF">Shortest Job First (SJF)</option>
        <option value="SJF Preemptive">SJF Preemptive</option>
        <option value="Round Robin">Round Robin</option>
        <option value="Priority">Priority Scheduling</option>
        <option value="Priority Preemptive">Priority Preemptive</option>
      </select><br><br>

      <label>Number of Processes:</label>
      <input type="number" id="processCount" name="process_count" value="1" min="1" onchange="updateProcessFields()">
      <br><br>

      <div id="processList"></div>

      <div id="quantumSection" style="display:none;">
        <label for="quantum">Time Quantum (For Round Robin):</label>
        <input type="number" id="quantum" name="quantum"><br>
      </div>

      <button type="submit">Calculate</button>
    </form>
  </main>

  <footer>
    <p>Â© 2025 CPU Schedulers Inc.</p>
  </footer>
</body>
</html>
